<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-04-22T17:32:54.5898379"><title>Начало работы | Распределённый калькулятор</title><script type="application/json" id="virtual-toc-data">[{"id":"-nyyygp_341","level":0,"title":"Запуск проекта","anchor":"#-nyyygp_341"},{"id":"-nyyygp_358","level":0,"title":"О проекте","anchor":"#-nyyygp_358"},{"id":"-nyyygp_366","level":0,"title":"Изменения в структуре приложения","anchor":"#-nyyygp_366"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b224/app.css" rel="stylesheet"><link rel="manifest" href="site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Начало работы | Распределённый калькулятор"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Распределённый калькулятор Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/how-to-start.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Начало работы | Распределённый калькулятор"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/how-to-start.html#webpage",
    "url": "writerside-documentation/how-to-start.html",
    "name": "Начало работы | Распределённый калькулятор",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Распределённый калькулятор Help"
}</script><!-- End Schema.org --></head><body data-id="How-to-start" data-main-title="Начало работы" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs=""><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Распределённый калькулятор  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="How-to-start" id="How-to-start.md">Начало работы</h1><p id="-nyyygp_340">Для работы приложения понадобится docker</p><section class="chapter"><h2 id="-nyyygp_341" data-toc="-nyyygp_341">Запуск проекта</h2><ul class="list _bullet" id="-nyyygp_342"><li class="list__item" id="-nyyygp_343"><p id="-nyyygp_344">клонируйте репозиторий и перейдите в корневую папку:</p><div class="code-block" data-lang="none">
git clone https://github.com/AleksandrVishniakov/distributed-calculator
cd distributed-calculator
</div></li><li class="list__item" id="-nyyygp_346"><p id="-nyyygp_347">выполните команду <code class="code" id="-nyyygp_348">make</code> или выполните команды из Makefile последовательно вручную:</p><div class="code-block" data-lang="none">
docker build -t dc-api-gateway:local ./api-gateway
docker build -t dc-daemon:local ./daemon
docker build -t dc-auth:local ./auth
docker build -t dc-page-parser:local ./page-parser
docker compose up
</div></li><li class="list__item" id="-nyyygp_350"><p id="-nyyygp_351">Если при запуске прокета возникли ошибки инициализации базы данных или у мигратора (goose), то помогает перезапуск (<code class="code" id="-nyyygp_352">make</code> или <code class="code" id="-nyyygp_353">docker compose up</code>). Если возники другие ошибки, пожалуйста, напишите <a href="https://t.me/landowner7" id="-nyyygp_354" data-external="true" rel="noopener noreferrer">сюда</a></p></li><li class="list__item" id="-nyyygp_355"><p id="-nyyygp_356">Готово! GUI приложения доступно на <a href="http://localhost:8080" id="-nyyygp_357" data-external="true" rel="noopener noreferrer">http://localhost:8080</a></p></li></ul></section><section class="chapter"><h2 id="-nyyygp_358" data-toc="-nyyygp_358">О проекте</h2><ul class="list _bullet" id="-nyyygp_359"><li class="list__item" id="-nyyygp_360"><p>интеркативный gui, связанный с сервером по http</p></li><li class="list__item" id="-nyyygp_361"><p>взаимодействие оркестратор-демон по grpc</p></li><li class="list__item" id="-nyyygp_362"><p>сохранение состояния в базу данных postgresql</p></li><li class="list__item" id="-nyyygp_363"><p>возможность восстановления после повторного включения</p></li><li class="list__item" id="-nyyygp_364"><p>proto-файлы можно найти в <a href="https://github.com/AleksandrVishniakov/dc-protos" id="-nyyygp_365" data-external="true" rel="noopener noreferrer">репозитории</a></p></li></ul></section><section class="chapter"><h2 id="-nyyygp_366" data-toc="-nyyygp_366">Изменения в структуре приложения</h2><p id="-nyyygp_367">Можно изменить порты, количество агентов, максимальное количество горутин и т.д. с помощью файла <code class="code" id="-nyyygp_368">docker-compose.yml</code>:</p><section class="chapter"><h3 id="docker-compose" data-toc="docker-compose">Сервисы docker-compose</h3></section><section class="chapter"><h3 id="api-gateway" data-toc="api-gateway">Api Gateway</h3><p id="-nyyygp_369">api-gateway - основной сервис приложения. Сюда приходят запросы из GUI, а также агентов</p><div class="code-block" data-lang="yaml">
api-gateway:
  image: dc-api-gateway:local
  container_name: dc-api-gateway
  environment:
    HTTP_PORT: 8000
    WORKERS_MONITORING_PERIOD_MS: 30000
    DB_PASSWORD: &quot;admin&quot;
  ports:
    - &quot;8000:8000&quot;
  depends_on:
    goose:
      condition: service_completed_successfully
</div><p id="-nyyygp_371">Переменные окружения:</p><ul class="list _bullet" id="-nyyygp_372"><li class="list__item" id="-nyyygp_373"><p><code class="code" id="-nyyygp_374">HTTP_PORT</code> - порт, на которм работает сервер. При изменении необходимо также изменить <code class="code" id="-nyyygp_375">ports</code></p></li><li class="list__item" id="-nyyygp_376"><p><code class="code" id="-nyyygp_377">WORKERS_MONITORING_PERIOD_MS</code> - период в миллисекундах, через который сервер проверяет, получен ли ping от всех агентов и удаляет неактивные</p></li><li class="list__item" id="-nyyygp_378"><p><code class="code" id="-nyyygp_379">DB_PASSWORD</code> - пароль для базы данных PostgreSQL</p></li></ul></section><section class="chapter"><h3 id="daemon" data-toc="daemon">Daemon</h3><p id="-nyyygp_380">daemon - агент, который выполняет арифметические вычисления</p><div class="code-block" data-lang="yaml">
daemon1:
  depends_on:
    - api-gateway
  image: dc-daemon:local
  container_name: dc-daemon-1
  environment:
    HTTP_PORT: 8001
    DAEMON_ID: 1
    DAEMON_HOST: &quot;http://daemon1:8001&quot; 
    ORCHESTRATOR_HOST: &quot;http://api-gateway:8000&quot;
    PING_PERIOD_MS: 25000
    MAX_GOROUTINES: 1
  ports:
    - &quot;8001:8001&quot;
</div><p id="-nyyygp_382">Переменные окружения:</p><ul class="list _bullet" id="-nyyygp_383"><li class="list__item" id="-nyyygp_384"><p><code class="code" id="-nyyygp_385">HTTP_PORT</code> - порт, на которм работает сервер. При изменении необходимо также изменить <code class="code" id="-nyyygp_386">ports</code> и <code class="code" id="-nyyygp_387">DAEMON_HOST</code></p></li><li class="list__item" id="-nyyygp_388"><p><code class="code" id="-nyyygp_389">DAEMON_ID</code> - иденитификатор демона, уникальный для каждого демона</p></li><li class="list__item" id="-nyyygp_390"><p><code class="code" id="-nyyygp_391">DAEMON_HOST</code> - адрес агента, по которому к нему можно обратиться</p></li><li class="list__item" id="-nyyygp_392"><p><code class="code" id="-nyyygp_393">ORCHESTRATOR_HOST</code> - адрес оркестратора (api-gateway)</p></li><li class="list__item" id="-nyyygp_394"><p><code class="code" id="-nyyygp_395">PING_PERIOD_MS: 25000</code> - период в миллисекудах, через который агент оправляет ping к оркестратору</p></li><li class="list__item" id="-nyyygp_396"><p><code class="code" id="-nyyygp_397">MAX_GOROUTINES</code> - маскимальное количество горутин, которые могут работать внутри агента</p></li></ul><p id="-nyyygp_398">Также можно добавить дополнительных агентов, изменив их названия, порты и идентификаторы</p></section><section class="chapter"><h3 id="page-parser" data-toc="page-parser">Page Parser</h3><p id="-nyyygp_399">Сервис отображает графический интерфейс</p><div class="code-block" data-lang="yaml">
page-parser:
    depends_on:
      - api-gateway
    image: dc-page-parser:local
    container_name: dc-page-parser
    environment:
      HTTP_PORT: &quot;8080&quot;
      ORCHESTRATOR_HOST: &quot;http://localhost:8000&quot;
    ports:
      - &quot;8080:8080&quot;
</div><p id="-nyyygp_401">Переменные окружения:</p><ul class="list _bullet" id="-nyyygp_402"><li class="list__item" id="-nyyygp_403"><p><code class="code" id="-nyyygp_404">HTTP_PORT</code> - порт, на которм работает сервер. При изменении необходимо также изменить <code class="code" id="-nyyygp_405">ports</code></p></li><li class="list__item" id="-nyyygp_406"><p><code class="code" id="-nyyygp_407">ORCHESTRATOR_HOST</code> - адрес оркестратора (api-gateway)</p></li></ul><p id="-nyyygp_408"><a href="https://t.me/landowner7" id="-nyyygp_409" data-external="true" rel="noopener noreferrer">По вопросам</a></p></section></section><div class="last-modified">Last modified: 22 апреля 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="project-overview.html" class="navigation-links__prev">Обзор проекта</a><a href="api-docs.html" class="navigation-links__next">Документация API</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b224/app.js"></script></body></html>